(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7387:function(e,t,n){Promise.resolve().then(n.bind(n,5720))},5720:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return $}});var s=n(7437),r=n(2265),a=n(2633),o=n(6826),i=n(7990),l=n(8800),d=n(5901),c=n(4120),m=n(7423),x=n(9659),u=n(2490),h=n(8260),y=n(855),p=n(9957);let f={"2024-01-01":{name:"元旦",type:"holiday"},"2024-02-10":{name:"春节",type:"holiday"},"2024-02-11":{name:"春节",type:"holiday"},"2024-02-12":{name:"春节",type:"holiday"},"2024-02-13":{name:"春节",type:"holiday"},"2024-02-14":{name:"春节",type:"holiday"},"2024-02-15":{name:"春节",type:"holiday"},"2024-02-16":{name:"春节",type:"holiday"},"2024-02-17":{name:"春节",type:"holiday"},"2024-02-04":{name:"春节调班",type:"workday"},"2024-04-04":{name:"清明节",type:"holiday"},"2024-04-05":{name:"清明节",type:"holiday"},"2024-04-06":{name:"清明节",type:"holiday"},"2024-03-31":{name:"清明调班",type:"workday"},"2024-05-01":{name:"劳动节",type:"holiday"},"2024-05-02":{name:"劳动节",type:"holiday"},"2024-05-03":{name:"劳动节",type:"holiday"},"2024-05-04":{name:"劳动节",type:"holiday"},"2024-05-05":{name:"劳动节",type:"holiday"},"2024-04-28":{name:"劳动节调班",type:"workday"},"2024-05-11":{name:"劳动节调班",type:"workday"},"2024-06-10":{name:"端午节",type:"holiday"},"2024-06-08":{name:"端午调班",type:"workday"},"2024-09-15":{name:"中秋节",type:"holiday"},"2024-09-16":{name:"中秋节",type:"holiday"},"2024-09-17":{name:"中秋节",type:"holiday"},"2024-09-14":{name:"中秋调班",type:"workday"},"2024-10-01":{name:"国庆节",type:"holiday"},"2024-10-02":{name:"国庆节",type:"holiday"},"2024-10-03":{name:"国庆节",type:"holiday"},"2024-10-04":{name:"国庆节",type:"holiday"},"2024-10-05":{name:"国庆节",type:"holiday"},"2024-10-06":{name:"国庆节",type:"holiday"},"2024-10-07":{name:"国庆节",type:"holiday"},"2024-09-29":{name:"国庆调班",type:"workday"},"2024-10-12":{name:"国庆调班",type:"workday"},"2025-01-01":{name:"元旦",type:"holiday"},"2025-01-28":{name:"春节",type:"holiday"},"2025-01-29":{name:"春节",type:"holiday"},"2025-01-30":{name:"春节",type:"holiday"},"2025-01-31":{name:"春节",type:"holiday"},"2025-02-01":{name:"春节",type:"holiday"},"2025-02-02":{name:"春节",type:"holiday"},"2025-02-03":{name:"春节",type:"holiday"},"2025-02-04":{name:"春节",type:"holiday"},"2025-01-26":{name:"春节调班",type:"workday"},"2025-02-08":{name:"春节调班",type:"workday"},"2025-04-04":{name:"清明节",type:"holiday"},"2025-04-05":{name:"清明节",type:"holiday"},"2025-04-06":{name:"清明节",type:"holiday"},"2025-05-01":{name:"劳动节",type:"holiday"},"2025-05-02":{name:"劳动节",type:"holiday"},"2025-05-03":{name:"劳动节",type:"holiday"},"2025-05-04":{name:"劳动节",type:"holiday"},"2025-05-05":{name:"劳动节",type:"holiday"},"2025-04-27":{name:"劳动节调班",type:"workday"},"2025-05-31":{name:"端午节",type:"holiday"},"2025-06-01":{name:"端午节",type:"holiday"},"2025-06-02":{name:"端午节",type:"holiday"},"2025-10-01":{name:"国庆节",type:"holiday"},"2025-10-02":{name:"国庆节",type:"holiday"},"2025-10-03":{name:"国庆节",type:"holiday"},"2025-10-04":{name:"国庆节",type:"holiday"},"2025-10-05":{name:"国庆节",type:"holiday"},"2025-10-06":{name:"国庆节",type:"holiday"},"2025-10-07":{name:"国庆节",type:"holiday"},"2025-10-08":{name:"国庆节",type:"holiday"},"2025-09-28":{name:"国庆调班",type:"workday"},"2025-10-11":{name:"国庆调班",type:"workday"}};function g(e){return f[(0,u.Z)(e,"yyyy-MM-dd")]||null}function v(e){let{selectedDate:t,onDateSelect:n,onDateContextMenu:f,hasContent:v}=e,[j,b]=(0,r.useState)(new Date),[w,N]=(0,r.useState)(!1),[k,S]=(0,r.useState)(!1),M=(0,r.useRef)(null),C=(0,r.useRef)(null),Z=(0,r.useRef)(null),L=(0,r.useRef)(null),D=(0,a.Z)(j),E=(0,o.Z)(j),O=(0,i.Z)(D,{weekStartsOn:1}),I=(0,l.Z)(E,{weekStartsOn:1}),B=(0,d.Z)({start:O,end:I}),W=e=>{let t=new Date(j);t.setFullYear(e),b(t),N(!1)},A=e=>{let t=new Date(j);t.setMonth(e),b(t),S(!1)};(0,r.useEffect)(()=>{(0,x.Z)(t,j)||b(t)},[t]);let J=j.getFullYear(),T=Array.from({length:21},(e,t)=>J-10+t),z=Array.from({length:12},(e,t)=>t);return(0,r.useEffect)(()=>{function e(e){w&&M.current&&Z.current&&!M.current.contains(e.target)&&!Z.current.contains(e.target)&&N(!1),k&&C.current&&L.current&&!C.current.contains(e.target)&&!L.current.contains(e.target)&&S(!1)}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[w,k]),(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4 relative",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("button",{onClick:()=>{let e=new Date(j);e.setFullYear(j.getFullYear()-1),b(e)},className:"p-2 text-secondary-600 hover:text-primary-500 transition-colors",children:(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 19l-7-7 7-7 M18 19l-7-7 7-7"})})}),(0,s.jsx)("button",{onClick:()=>b((0,m.Z)(j,1)),className:"p-2 text-secondary-600 hover:text-primary-500 transition-colors",children:(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsxs)("div",{className:"relative mr-1",children:[(0,s.jsx)("button",{ref:Z,onClick:()=>{N(!w),S(!1)},className:"text-lg font-medium text-secondary-900 hover:text-primary-500 transition-colors",children:(0,u.Z)(j,"yyyy年",{locale:p.Z})}),w&&(0,s.jsx)("div",{ref:M,className:"absolute z-10 mt-1 bg-white shadow-lg rounded-md border border-gray-200 max-h-60 overflow-y-auto grid grid-cols-3 gap-2 p-2 w-48",children:T.map(e=>(0,s.jsx)("button",{onClick:()=>W(e),className:"text-center py-2 px-2 rounded ".concat(e===J?"bg-primary-500 text-white":"hover:bg-primary-50"),children:e},e))})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("button",{ref:L,onClick:()=>{S(!k),N(!1)},className:"text-lg font-medium text-secondary-900 hover:text-primary-500 transition-colors",children:(0,u.Z)(j,"MM月",{locale:p.Z})}),k&&(0,s.jsx)("div",{ref:C,className:"absolute z-10 mt-1 bg-white shadow-lg rounded-md border border-gray-200 max-h-60 overflow-y-auto grid grid-cols-3 gap-2 p-2 w-48",children:z.map(e=>(0,s.jsxs)("button",{onClick:()=>A(e),className:"text-center py-2 px-2 rounded ".concat(e===j.getMonth()?"bg-primary-500 text-white":"hover:bg-primary-50"),children:[e+1,"月"]},e))})]})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("button",{onClick:()=>b((0,c.Z)(j,1)),className:"p-2 text-secondary-600 hover:text-primary-500 transition-colors",children:(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),(0,s.jsx)("button",{onClick:()=>{let e=new Date(j);e.setFullYear(j.getFullYear()+1),b(e)},className:"p-2 text-secondary-600 hover:text-primary-500 transition-colors",children:(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 5l7 7-7 7 M6 5l7 7-7 7"})})})]})]}),(0,s.jsx)("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["一","二","三","四","五","六","日"].map(e=>(0,s.jsx)("div",{className:"text-center text-sm font-medium text-secondary-600",children:e},e))}),(0,s.jsx)("div",{className:"grid grid-cols-7 gap-1",children:B.map(e=>{let r=v(e),a=(0,h.Z)(e,t),o=(0,x.Z)(e,j),i=g(e);!function(e){let t=g(e);null==t||t.type}(e);let l=function(e){let t=g(e);return(null==t?void 0:t.type)==="workday"}(e);return(0,y.Z)(e),(0,s.jsx)("button",{onClick:()=>n(e),onContextMenu:t=>f(e,t),className:"\n                relative p-2 text-sm transition-all\n                ".concat(a?"bg-primary-50 text-primary-600 font-medium":"hover:bg-primary-50","\n                ").concat(!o&&"text-secondary-300","\n              "),children:(0,s.jsxs)("div",{className:"relative h-6 flex items-center justify-center",children:[(0,s.jsx)("span",{className:"inline-flex items-center justify-center w-6",children:(0,u.Z)(e,"d")}),i&&(0,s.jsx)("span",{className:"\n                    absolute -top-1 -right-1 text-[10px] leading-none px-0.5\n                    ".concat(l?"text-red-500":"text-primary-500","\n                  "),children:l?"班":"休"}),(0,s.jsx)("div",{className:"absolute -bottom-1 left-1/2 transform -translate-x-1/2 flex gap-0.5 items-center",children:r.events.map(e=>(0,s.jsx)("div",{className:"w-1 h-1 rounded-full ".concat(e.color)},e.id))})]})},e.toString())})}),(0,s.jsx)("div",{className:"mt-2 text-center",children:(0,s.jsx)("button",{onClick:()=>{let e=new Date;b(e),n(e)},className:"text-sm text-primary-500 hover:text-primary-600 transition-colors",children:"返回今天"})})]})}function j(e){let{date:t,initialContent:n,onSave:a}=e,[o,i]=(0,r.useState)(n),[l,d]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{i(n)},[n,t]),(0,r.useEffect)(()=>{let e=setTimeout(()=>{o===n||l||(d(!0),a(o),d(!1))},1e3);return()=>clearTimeout(e)},[o,n,l,a]),(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsx)("textarea",{value:o,onChange:e=>i(e.target.value),placeholder:"写下今天的记录...",className:"w-full h-48 p-3 text-sm border border-secondary-200 rounded-lg focus:outline-none focus:border-primary-400 focus:ring-1 focus:ring-primary-100 transition-all resize-none text-secondary-700 placeholder-secondary-400"}),(0,s.jsx)("div",{className:"flex justify-end mt-1.5",children:(0,s.jsxs)("span",{className:"text-xs text-secondary-400 flex items-center",children:[(0,s.jsx)("span",{className:"w-1.5 h-1.5 rounded-full mr-1.5 ".concat(l?"bg-primary-400 animate-pulse":"bg-green-400")}),l?"保存中...":"已自动保存"]})})]})}var b=n(802),w=n(8873);function N(e){let{isOpen:t,onClose:n,onSave:a,initialContent:o="",initialDate:i=new Date,mode:l}=e,[d,c]=(0,r.useState)(o),[m,x]=(0,r.useState)(i);return((0,r.useEffect)(()=>{t&&(c(o),x(i))},[t,o,i]),t)?(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg p-4 w-full max-w-sm",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-4 text-primary-600",children:"edit"===l?"编辑待办事项":"复制待办事项"}),(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),d.trim()&&(a(d.trim(),m),n())},children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-secondary-600 mb-1",children:"内容"}),(0,s.jsx)("input",{type:"text",value:d,onChange:e=>c(e.target.value),className:"w-full px-3 py-1.5 text-sm border border-secondary-200 rounded-lg focus:outline-none focus:border-primary-400 focus:ring-1 focus:ring-primary-100 transition-all",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-secondary-600 mb-1",children:"日期"}),(0,s.jsx)("input",{type:"date",value:(0,u.Z)(m,"yyyy-MM-dd"),onChange:e=>x(new Date(e.target.value)),className:"w-full px-3 py-1.5 text-sm border border-secondary-200 rounded-lg focus:outline-none focus:border-primary-400 focus:ring-1 focus:ring-primary-100 transition-all",required:!0})]})]}),(0,s.jsxs)("div",{className:"mt-4 flex justify-end gap-2",children:[(0,s.jsx)("button",{type:"button",onClick:n,className:"px-3 py-1.5 text-sm border border-secondary-200 text-secondary-600 rounded-lg hover:bg-secondary-50 transition-colors",children:"取消"}),(0,s.jsx)("button",{type:"submit",className:"px-3 py-1.5 text-sm bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:"保存"})]})]})]})}):null}var k=n(2542),S=n(8168);function M(e){let{onConfirm:t,children:n}=e;return(0,s.jsxs)(k.J2,{className:"relative",children:[n,(0,s.jsx)(S.u,{as:r.Fragment,enter:"transition ease-out duration-200",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",children:(0,s.jsx)(k.J2.Panel,{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 z-10",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-xl ring-1 ring-black/5 p-4 min-w-[140px]",children:[(0,s.jsx)("p",{className:"text-xs text-secondary-700 mb-3 text-center font-medium",children:"确定要删除吗？"}),(0,s.jsxs)("div",{className:"flex gap-2 justify-center",children:[(0,s.jsx)(k.J2.Button,{className:"min-w-[48px] px-3 py-1.5 text-xs border border-secondary-200 text-secondary-600 rounded-md hover:bg-secondary-50 hover:border-secondary-300 transition-all",children:"取消"}),(0,s.jsx)(k.J2.Button,{className:"min-w-[48px] px-3 py-1.5 text-xs bg-red-500 text-white rounded-md hover:bg-red-600 transition-all",onClick:t,children:"删除"})]})]})})})]})}var C=n(7135),Z=n(4048),L=n(1216);function D(e){let{todo:t,onToggle:n,onEdit:r,onCopy:a,onDelete:o,isDragging:i=!1}=e,{attributes:l,listeners:d,setNodeRef:c,transform:m,transition:x,isDragging:u}=(0,Z.nB)({id:t.id,transition:{duration:300,easing:"ease"}}),h={transform:L.ux.Transform.toString(m),transition:x||void 0,opacity:u?0:1};return(0,s.jsxs)("div",{ref:c,style:h,className:"flex items-center justify-between py-2 px-3 bg-white border rounded-lg transition-colors ".concat(i?"border-primary-400 shadow-lg bg-primary-50 scale-[1.02]":"border-secondary-200 hover:border-primary-200"),children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("button",{className:"text-secondary-400 cursor-grab active:cursor-grabbing",...l,...d,children:(0,s.jsx)(w._4k,{className:"w-4 h-4"})}),(0,s.jsx)("button",{onClick:()=>n(t.id),className:"w-5 h-5 rounded-md border-2 flex items-center justify-center transition-all ".concat(t.completed?"bg-primary-500 border-primary-500 text-white":"border-secondary-300 hover:border-primary-400"),children:t.completed&&(0,s.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,s.jsx)("span",{className:"text-sm text-secondary-700 transition-all ".concat(t.completed?"line-through text-secondary-400":""),children:t.content})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("button",{onClick:()=>r(t),className:"text-secondary-400 hover:text-primary-500 transition-colors p-1.5",title:"编辑",children:(0,s.jsx)(b.IYd,{className:"w-3.5 h-3.5"})}),(0,s.jsx)("button",{onClick:()=>a(t),className:"text-secondary-400 hover:text-primary-500 transition-colors p-1.5",title:"复制",children:(0,s.jsx)(b.C3L,{className:"w-3.5 h-3.5"})}),(0,s.jsx)(M,{onConfirm:()=>o(t.id),children:(0,s.jsx)(k.J2.Button,{className:"text-secondary-400 hover:text-red-500 transition-colors p-1.5",children:(0,s.jsx)(b.Ybf,{className:"w-3.5 h-3.5"})})})]})]})}function E(e){let{todos:t,selectedDate:n,onAdd:a,onToggle:o,onDelete:i,onEdit:l,onReorder:d}=e,[c,m]=(0,r.useState)(""),[x,u]=(0,r.useState)(!1),[h,y]=(0,r.useState)(null),[p,f]=(0,r.useState)("edit"),[g,v]=(0,r.useState)(null),j=(0,C.Dy)((0,C.VT)(C.we,{activationConstraint:{distance:8,tolerance:5,delay:150}}),(0,C.VT)(C.Lg,{coordinateGetter:Z.is})),b=e=>{y(e),f("edit"),u(!0)},w=e=>{y(e),f("copy"),u(!0)};return(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),c.trim()&&(a(c.trim(),n),m(""))},className:"flex gap-3 mb-4",children:[(0,s.jsx)("input",{type:"text",value:c,onChange:e=>m(e.target.value),placeholder:"添加新的待办事项...",className:"flex-1 px-3 py-1.5 text-sm border border-secondary-200 rounded-lg focus:outline-none focus:border-primary-400 focus:ring-1 focus:ring-primary-100 transition-all"}),(0,s.jsx)("button",{type:"submit",className:"px-4 py-1.5 text-sm bg-primary-500 text-white rounded-lg hover:bg-primary-600 focus:outline-none focus:ring-2 focus:ring-primary-200 transition-all",children:"添加"})]}),(0,s.jsx)("div",{className:"space-y-2",children:(0,s.jsxs)(C.LB,{sensors:j,collisionDetection:C.Xo,onDragStart:e=>{let{active:n}=e,s=t.find(e=>e.id===n.id);s&&v(s)},onDragEnd:e=>{let{active:n,over:s}=e;if(s&&n.id!==s.id){let e=t.findIndex(e=>e.id===n.id),r=t.findIndex(e=>e.id===s.id);d&&d(e,r)}v(null)},children:[(0,s.jsx)(Z.Fo,{items:t.map(e=>e.id),strategy:Z.qw,children:t.map(e=>(0,s.jsx)(D,{todo:e,onToggle:o,onEdit:b,onCopy:w,onDelete:i,isDragging:(null==g?void 0:g.id)===e.id},e.id))}),(0,s.jsx)(C.y9,{dropAnimation:{duration:300,easing:"ease"},children:g?(0,s.jsx)(D,{todo:g,onToggle:o,onEdit:b,onCopy:w,onDelete:i,isDragging:!0}):null})]})}),(0,s.jsx)(N,{isOpen:x,onClose:()=>u(!1),onSave:(e,t)=>{"edit"===p&&h?l(h.id,e,t):a(e,t)},initialContent:null==h?void 0:h.content,initialDate:(null==h?void 0:h.date)?new Date(h.date):n,mode:p})]})}let O={"bg-red-500":"红色","bg-yellow-500":"黄色","bg-blue-500":"蓝色","bg-green-500":"绿色","bg-purple-500":"紫色","bg-pink-500":"粉色"};function I(e){let{isOpen:t,onClose:n,onSave:a,date:o,mode:i="add",initialEvent:l}=e,[d,c]=(0,r.useState)(""),[m,x]=(0,r.useState)("bg-blue-500"),[h,y]=(0,r.useState)(o),p=(0,r.useRef)(null);return((0,r.useEffect)(()=>{t&&p.current&&p.current.focus()},[t]),(0,r.useEffect)(()=>{t&&l?(c(l.title),x(l.color),y(new Date(l.date))):t&&(c(""),x("bg-blue-500"),y(o))},[t,l,o]),t)?(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg p-4 w-full max-w-sm",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-4 text-primary-600",children:"add"===i?"添加事件":"编辑事件"}),(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),a({title:d,color:m,date:(0,u.Z)(h,"yyyy-MM-dd")}),c(""),x("bg-blue-500"),y(o),n()},children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-secondary-600 mb-1",children:"事件标题"}),(0,s.jsx)("input",{type:"text",value:d,ref:p,onChange:e=>c(e.target.value),className:"w-full px-3 py-1.5 text-sm border border-secondary-200 rounded-lg focus:outline-none focus:border-primary-400 focus:ring-1 focus:ring-primary-100 transition-all",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-secondary-600 mb-1",children:"日期"}),(0,s.jsx)("input",{type:"date",value:(0,u.Z)(h,"yyyy-MM-dd"),onChange:e=>y(new Date(e.target.value)),className:"w-full px-3 py-1.5 text-sm border border-secondary-200 rounded-lg focus:outline-none focus:border-primary-400 focus:ring-1 focus:ring-primary-100 transition-all",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-secondary-600 mb-1",children:"事件颜色"}),(0,s.jsx)("div",{className:"grid grid-cols-6 gap-2",children:Object.entries(O).map(e=>{let[t,n]=e;return(0,s.jsx)("button",{type:"button",onClick:()=>x(t),className:"w-8 h-8 rounded-lg ".concat(t," transition-all ").concat(m===t?"ring-2 ring-primary-400 ring-offset-2":""),title:n},t)})})]})]}),(0,s.jsxs)("div",{className:"mt-4 flex justify-end gap-2",children:[(0,s.jsx)("button",{type:"button",onClick:n,className:"px-3 py-1.5 text-sm border border-secondary-200 text-secondary-600 rounded-lg hover:bg-secondary-50 transition-colors",children:"取消"}),(0,s.jsx)("button",{type:"submit",className:"px-3 py-1.5 text-sm bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:"保存"})]})]})]})}):null}var B=n(8716);function W(e){localStorage.setItem("todos",JSON.stringify(e))}function A(){let e=localStorage.getItem("todos");return e?JSON.parse(e):[]}function J(){return Math.random().toString(36).substring(2)+Date.now().toString(36)}function T(e){return(0,u.Z)(e,"yyyy-MM-dd")}function z(){let e=localStorage.getItem("notes");return e?JSON.parse(e):[]}function F(e){return z().find(t=>t.date===T(e))||null}function R(e){localStorage.setItem("events",JSON.stringify(e))}function V(){let e=localStorage.getItem("events");return e?JSON.parse(e):[]}function H(e){return V().filter(t=>t.date===T(e))}function Y(e,t){let n=V(),s=n.findIndex(t=>t.id===e);if(-1===s)return null;let r={...n[s],status:t};return n[s]=r,R(n),r}function _(e){let t=z(),n=A(),s=V(),r="工作记录导出\n\n";return e.forEach(e=>{let a=(0,u.Z)(e,"yyyy-MM-dd"),o=(0,u.Z)(e,"yyyy年MM月dd日 EEEE",{locale:p.Z}),i=s.filter(e=>e.date===a),l=n.filter(e=>e.date===a),d=t.find(e=>e.date===a);(0!==i.length||0!==l.length||(null==d?void 0:d.content))&&(r+="=== ".concat(o," ===\n\n"),i.length>0&&(r+="【事件】\n",i.forEach(e=>{r+="- ".concat(e.title,"\n")}),r+="\n"),l.length>0&&(r+="【待办事项】\n",l.forEach(e=>{r+="- [".concat(e.completed?"✓":" ","] ").concat(e.content,"\n")}),r+="\n"),(null==d?void 0:d.content)&&(r+="【日记】\n"+d.content+"\n\n"),r+="----------------------------\n\n")}),r}function q(e,t){let n=new Blob([e],{type:"text/plain;charset=utf-8"}),s=URL.createObjectURL(n),r=document.createElement("a");r.href=s,r.download="".concat(t,"_").concat((0,u.Z)(new Date,"yyyy-MM-dd"),".txt"),document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(s)}function U(e){let{isOpen:t,onClose:n,date:c,notes:m,todos:x,events:h,type:y}=e;if(!t)return null;let f=(0,r.useRef)(null),{start:g,end:v,title:j}=(()=>{if("week"===y){let e=(0,i.Z)(c,{weekStartsOn:1}),t=(0,l.Z)(c,{weekStartsOn:1});return{start:e,end:t,title:"周报（".concat((0,u.Z)(e,"MM.dd",{locale:p.Z})," - ").concat((0,u.Z)(t,"MM.dd",{locale:p.Z}),"）")}}return{start:(0,a.Z)(c),end:(0,o.Z)(c),title:"".concat((0,u.Z)(c,"yyyy年MM月",{locale:p.Z}),"月报")}})(),b=(0,d.Z)({start:g,end:v}),w=e=>(0,u.Z)(e,"yyyy-MM-dd");return(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg w-full max-w-4xl max-h-[90vh] flex flex-col",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-secondary-200",children:[(0,s.jsx)("h2",{className:"text-base font-semibold text-primary-600",children:j}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("button",{onClick:()=>{"week"===y?function(e){let t=(0,i.Z)(e,{weekStartsOn:1}),n=(0,l.Z)(e,{weekStartsOn:1});q(_((0,d.Z)({start:t,end:n})),"周报")}(c):function(e){let t=(0,a.Z)(e),n=(0,o.Z)(e);q(_((0,d.Z)({start:t,end:n})),"月报")}(c)},className:"px-3 py-1.5 text-sm bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors flex items-center gap-1.5",title:"下载为文本",children:[(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),(0,s.jsx)("span",{children:"下载"})]}),(0,s.jsx)("button",{onClick:n,className:"text-secondary-400 hover:text-secondary-600 transition-colors",children:(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),(0,s.jsx)("div",{className:"flex-1 overflow-auto p-4",ref:f,"data-report-content":!0,children:(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 auto-rows-min",children:[b.map(e=>{let t=w(e),n=m.filter(e=>e.date===t),r=x.filter(e=>e.date===t),a=h.filter(e=>e.date===t);return 0===n.length&&0===r.length&&0===a.length?null:(0,s.jsxs)("div",{className:"border border-secondary-200 rounded-lg p-2",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-primary-600 mb-2",children:(0,u.Z)(e,"MM月dd日 EEEE",{locale:p.Z})}),a.length>0&&(0,s.jsxs)("div",{className:"mb-2",children:[(0,s.jsx)("h4",{className:"text-xs font-medium text-secondary-600 mb-1",children:"事件"}),(0,s.jsx)("div",{className:"space-y-0.5",children:a.map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-1.5 text-xs",children:[(0,s.jsx)("div",{className:"w-1.5 h-1.5 rounded-full ".concat(e.color)}),(0,s.jsx)("span",{className:"text-secondary-700",children:e.title})]},e.id))})]}),r.length>0&&(0,s.jsxs)("div",{className:"mb-2",children:[(0,s.jsx)("h4",{className:"text-xs font-medium text-secondary-600 mb-1",children:"待办事项"}),(0,s.jsx)("div",{className:"space-y-0.5",children:r.map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-1.5 text-xs",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded border flex items-center justify-center ".concat(e.completed?"bg-primary-500 border-primary-500 text-white":"border-secondary-300"),children:e.completed&&(0,s.jsx)("svg",{className:"w-1.5 h-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,s.jsx)("span",{className:"text-secondary-700 ".concat(e.completed?"line-through":""),children:e.content})]},e.id))})]}),n.map(e=>(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-xs font-medium text-secondary-600 mb-1",children:"日记"}),(0,s.jsx)("div",{className:"text-xs text-secondary-700 whitespace-pre-wrap",children:e.content})]},e.id))]},t)}),b.every(e=>{let t=w(e),n=m.filter(e=>e.date===t),s=x.filter(e=>e.date===t),r=h.filter(e=>e.date===t);return 0===n.length&&0===s.length&&0===r.length})&&(0,s.jsx)("div",{className:"text-center py-4 text-xs text-secondary-400",children:"week"===y?"本周暂无任何记录":"本月暂无任何记录"})]})})]})})}var P=n(1189),G=n(3345),X=n(8240),K=n(6678);let Q=e=>e?e.replace("bg-","text-"):"text-secondary-600";function $(){let[e,t]=(0,r.useState)(new Date),[n,c]=(0,r.useState)(null),[m,x]=(0,r.useState)([]),[h,y]=(0,r.useState)([]),[f,g]=(0,r.useState)([]),[b,w]=(0,r.useState)(!1),[N,S]=(0,r.useState)(null),[C,Z]=(0,r.useState)(!1),[L,D]=(0,r.useState)(!1),[O,$]=(0,r.useState)(!1),[ee,et]=(0,r.useState)({notes:[],todos:[],events:[]}),[en,es]=(0,r.useState)({notes:[],todos:[],events:[]});(0,r.useEffect)(()=>{Z(!0)},[]),(0,r.useEffect)(()=>{C&&(er(),ea())},[e,C]);let er=()=>{if(!C)return;c(F(e)),y(H(e));let t=(0,u.Z)(e,"yyyy-MM-dd");x(A().filter(e=>e.date===t))},ea=()=>{C&&g(V().filter(e=>{let t=new Date(e.date);return((0,P.Z)(t)||(0,G.Z)(t))&&(!e.status||"active"===e.status)}).sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime()))},eo=e=>{let t=new Date(e),n=new Date;if((0,P.Z)(t))return"今天";if((0,X.Z)(t))return"明天";let s=(0,K.Z)(t,n);return"".concat((0,u.Z)(t,"MM.dd",{locale:p.Z}),"（").concat(s,"天后）")},ei=e=>{S(e),w(!0)},el=()=>{if(!C)return;let t=(0,i.Z)(e,{weekStartsOn:1}),n=(0,l.Z)(e,{weekStartsOn:1}),s=(0,d.Z)({start:t,end:n}),r=[],a=[],o=[];s.forEach(e=>{let t=F(e);t&&r.push(t);let n=(0,u.Z)(e,"yyyy-MM-dd"),s=A().filter(e=>e.date===n);a.push(...s);let i=H(e);o.push(...i)}),et({notes:r,todos:a,events:o})},ed=()=>{if(!C)return;let t=(0,a.Z)(e),n=(0,o.Z)(e),s=(0,d.Z)({start:t,end:n}),r=[],i=[],l=[];s.forEach(e=>{let t=F(e);t&&r.push(t);let n=(0,u.Z)(e,"yyyy-MM-dd"),s=A().filter(e=>e.date===n);i.push(...s);let a=H(e);l.push(...a)}),es({notes:r,todos:i,events:l})};return C?(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-b from-primary-50 to-white",children:[(0,s.jsxs)("main",{className:"container mx-auto px-4 py-6 max-w-6xl",children:[(0,s.jsxs)("h1",{className:"text-sm font-medium text-primary-600 text-center mb-6 flex items-center justify-center gap-1",children:[(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 14s1.5 2 4 2 4-2 4-2M9 9h.01M15 9h.01M20 12a8 8 0 11-16 0 8 8 0 0116 0z"})}),"饼干工作日记"]}),(0,s.jsxs)("div",{className:"flex gap-4 mb-6",children:[(0,s.jsx)("div",{className:"max-h-[100px] bg-white rounded-xl shadow-soft p-2.5 overflow-y-auto flex-1 max-w-[600px]",children:(0,s.jsxs)("div",{className:"space-y-0.5",children:[f.map(e=>(0,s.jsxs)("div",{className:"grid grid-cols-[1.5rem,6rem,1fr] items-center",children:[(0,s.jsx)("div",{className:"flex items-center justify-center",children:(0,s.jsx)("div",{className:"w-1.5 h-1.5 rounded-full ".concat(e.color||"bg-secondary-400")})}),(0,s.jsx)("div",{className:"text-xs text-secondary-500",children:eo(e.date)}),(0,s.jsx)("div",{className:"text-xs text-secondary-700 truncate pr-2",children:e.title})]},e.id)),0===f.length&&(0,s.jsx)("div",{className:"py-2 flex items-center justify-center text-xs text-secondary-400",children:"暂无即将发生的事件"})]})}),(0,s.jsxs)("div",{className:"flex items-center gap-2 ml-auto",children:[(0,s.jsxs)("button",{onClick:()=>{t(new Date)},className:"h-[60px] px-3 bg-white rounded-xl shadow-soft text-xs text-secondary-600 hover:text-primary-500 transition-colors flex flex-col items-center justify-center gap-0.5",children:[(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,s.jsx)("span",{children:"回到今天"})]}),(0,s.jsxs)("button",{onClick:()=>{el(),D(!0)},className:"h-[60px] px-3 bg-white rounded-xl shadow-soft text-xs text-secondary-600 hover:text-primary-500 transition-colors flex flex-col items-center justify-center gap-0.5",children:[(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,s.jsx)("span",{children:"周报"})]}),(0,s.jsxs)("button",{onClick:()=>{ed(),$(!0)},className:"h-[60px] px-3 bg-white rounded-xl shadow-soft text-xs text-secondary-600 hover:text-primary-500 transition-colors flex flex-col items-center justify-center gap-0.5",children:[(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),(0,s.jsx)("span",{children:"月报"})]}),(0,s.jsxs)("button",{onClick:()=>{let e=document.createElement("input");e.type="file",e.accept=".txt",e.onchange=async e=>{var t;let n=null===(t=e.target.files)||void 0===t?void 0:t[0];if(n)try{await new Promise((e,t)=>{let s=new FileReader;s.onload=async n=>{try{var s,r;let t=(null===(s=n.target)||void 0===s?void 0:s.result).replace(/^工作记录导出\n+/,""),a=t.split(/===[\s\S]*?===/).filter(e=>e.trim()),o=(null===(r=t.match(/===\s*(.*?)\s*===/g))||void 0===r?void 0:r.map(e=>e.replace(/===\s*|\s*===/g,"").trim()))||[],i=[],l=[],d=[];if(a.forEach((e,t)=>{if(!o[t])return;let n=o[t].match(/(\d{4})年(\d{2})月(\d{2})日/);if(!n)return;let s=new Date(parseInt(n[1]),parseInt(n[2])-1,parseInt(n[3])),r=(0,u.Z)(s,"yyyy-MM-dd"),a="",c="",m=e.trim().split("\n");for(let e=0;e<m.length;e++){let t=m[e].trim();if(t&&"----------------------------"!==t){if("【事件】"===t){a="events";continue}if("【待办事项】"===t){a="todos";continue}if("【日记】"===t){a="notes";continue}if("events"===a&&t.startsWith("-")){let e=t.slice(2).trim();d.push({id:Math.random().toString(36).substring(2)+Date.now().toString(36),title:e,date:r,color:"bg-blue-500",createdAt:new Date().toISOString()})}else if("todos"===a&&t.startsWith("-")){let e=t.includes("[✓]"),n=t.slice(t.indexOf("]")+1).trim();l.push({id:Math.random().toString(36).substring(2)+Date.now().toString(36),content:n,completed:e,date:r,createdAt:new Date().toISOString(),completedAt:e?new Date().toISOString():void 0})}else"notes"===a&&(c+=(c?"\n":"")+t)}}if(c){let e=new Date().toISOString();i.push({id:Math.random().toString(36).substring(2)+Date.now().toString(36),content:c,date:r,createdAt:e,updatedAt:e})}}),0===i.length&&0===l.length&&0===d.length)throw Error("没有解析到任何数据");localStorage.clear(),localStorage.setItem("notes",JSON.stringify(i)),localStorage.setItem("todos",JSON.stringify(l)),localStorage.setItem("events",JSON.stringify(d)),e()}catch(e){t(e)}},s.onerror=()=>t(Error("文件读取失败")),s.readAsText(n)}),er(),ea(),alert("导入成功！页面将刷新以显示导入的数据。"),window.location.reload()}catch(e){console.error("导入失败:",e),alert("导入失败，请确保文件格式正确。")}},e.click()},className:"h-[60px] px-3 bg-white rounded-xl shadow-soft text-xs text-secondary-600 hover:text-primary-500 transition-colors flex flex-col items-center justify-center gap-0.5",children:[(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),(0,s.jsx)("span",{children:"导入"})]}),(0,s.jsxs)("button",{onClick:()=>{C&&function(){let e=z(),t=A(),n=V(),s=new Set;e.forEach(e=>s.add(e.date)),t.forEach(e=>s.add(e.date)),n.forEach(e=>s.add(e.date)),q(_(Array.from(s).sort().map(e=>(0,B.Z)(e))),"工作记录")}()},className:"h-[60px] px-3 bg-white rounded-xl shadow-soft text-xs text-secondary-600 hover:text-primary-500 transition-colors flex flex-col items-center justify-center gap-0.5",children:[(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),(0,s.jsx)("span",{children:"导出"})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[(0,s.jsxs)("div",{className:"lg:col-span-4 space-y-4",children:[(0,s.jsx)("div",{className:"bg-white rounded-xl shadow-soft p-4",children:(0,s.jsx)(v,{selectedDate:e,onDateSelect:e=>{t(e)},onDateContextMenu:(e,n)=>{n.preventDefault(),t(e),w(!0)},hasContent:e=>C?{events:H(e).filter(e=>!e.status||"active"===e.status)}:{events:[]}})}),(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-soft p-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-primary-600",children:"事件"}),(0,s.jsx)("button",{onClick:()=>w(!0),className:"px-3 py-1 text-sm bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:"添加"})]}),(0,s.jsxs)("div",{className:"space-y-1.5",children:[h.map(e=>(0,s.jsxs)("div",{className:"py-1.5 px-2 rounded-lg border border-secondary-200 flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-1.5 h-1.5 rounded-full ".concat(e.color||"bg-secondary-400")}),(0,s.jsxs)("div",{className:"text-xs font-medium flex-1 ".concat(Q(e.color)),children:[e.title,e.status&&"active"!==e.status&&(0,s.jsxs)("span",{className:"ml-2 text-secondary-400",children:["(","cancelled"===e.status?"已取消":"已延期",")"]})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(!e.status||"active"===e.status)&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"group relative",children:[(0,s.jsx)("button",{onClick:()=>{C&&(Y(e.id,"cancelled"),er(),ea())},className:"text-secondary-400 hover:text-red-500 transition-colors p-0.5",children:(0,s.jsx)("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})}),(0,s.jsx)("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-1 px-2 py-1 text-xs text-white bg-gray-800 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap",children:"标记为已取消"})]}),(0,s.jsxs)("div",{className:"group relative",children:[(0,s.jsx)("button",{onClick:()=>{C&&(Y(e.id,"postponed"),er(),ea())},className:"text-secondary-400 hover:text-yellow-500 transition-colors p-0.5",children:(0,s.jsx)("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,s.jsx)("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-1 px-2 py-1 text-xs text-white bg-gray-800 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap",children:"标记为已延期"})]})]}),e.status&&"active"!==e.status&&(0,s.jsxs)("div",{className:"group relative",children:[(0,s.jsx)("button",{onClick:()=>{C&&(Y(e.id,"active"),er(),ea())},className:"text-secondary-400 hover:text-green-500 transition-colors p-0.5",children:(0,s.jsx)("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),(0,s.jsx)("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-1 px-2 py-1 text-xs text-white bg-gray-800 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap",children:"恢复为活动状态"})]}),(0,s.jsxs)("div",{className:"group relative",children:[(0,s.jsx)("button",{onClick:()=>ei(e),className:"text-secondary-400 hover:text-primary-500 transition-colors p-0.5",children:(0,s.jsx)("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),(0,s.jsx)("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-1 px-2 py-1 text-xs text-white bg-gray-800 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap",children:"编辑事件"})]}),(0,s.jsxs)("div",{className:"group relative",children:[(0,s.jsx)(M,{onConfirm:()=>{C&&(!function(e){let t=V(),n=t.findIndex(t=>t.id===e);-1!==n&&(t.splice(n,1),R(t))}(e.id),er(),ea())},children:(0,s.jsx)(k.J2.Button,{className:"text-secondary-400 hover:text-red-500 transition-colors p-0.5",children:(0,s.jsx)("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})}),(0,s.jsx)("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-1 px-2 py-1 text-xs text-white bg-gray-800 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap",children:"删除事件"})]})]})]},e.id)),0===h.length&&(0,s.jsx)("div",{className:"text-center py-3 text-xs text-secondary-400",children:"暂无事件"})]})]})]}),(0,s.jsxs)("div",{className:"lg:col-span-8 space-y-4",children:[(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-soft p-4",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-3 text-primary-600",children:"日记"}),(0,s.jsx)(j,{date:e,initialContent:(null==n?void 0:n.content)||"",onSave:t=>{C&&(!function(e,t){let n=z(),s=n.find(e=>e.date===T(t)),r=new Date().toISOString();s?(s.content=e,s.updatedAt=r):n.push({id:J(),content:e,date:T(t),createdAt:r,updatedAt:r}),localStorage.setItem("notes",JSON.stringify(n))}(t,e),er())}})]}),(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-soft p-4",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-3 text-primary-600",children:"待办事项"}),(0,s.jsx)(E,{todos:m,selectedDate:e,onAdd:(e,t)=>{C&&(x([...m,function(e,t){let n=A(),s={id:J(),content:e,completed:!1,date:T(t),createdAt:new Date().toISOString()};return n.push(s),localStorage.setItem("todos",JSON.stringify(n)),s}(e,t)]),er())},onToggle:e=>{C&&(!function(e){let t=A(),n=t.find(t=>t.id===e);n&&(n.completed=!n.completed,n.completedAt=n.completed?new Date().toISOString():void 0,W(t))}(e),x(A()),er())},onDelete:e=>{C&&(!function(e){let t=A(),n=t.findIndex(t=>t.id===e);-1!==n&&(t.splice(n,1),W(t))}(e),x(t=>t.filter(t=>t.id!==e)))},onEdit:(e,t,n)=>{C&&(!function(e,t,n){let s=A(),r=s.findIndex(t=>t.id===e);if(-1===r)return;let a={...s[r],content:t,date:T(n)};s[r]=a,localStorage.setItem("todos",JSON.stringify(s))}(e,t,n),x(A()),er())},onReorder:(t,n)=>{if(!C)return;let s=A(),r=(0,u.Z)(e,"yyyy-MM-dd"),a=s.filter(e=>e.date===r),o=s.filter(e=>e.date!==r),[i]=a.splice(t,1);a.splice(n,0,i),W([...o,...a]),x(a)}})]})]})]})]}),(0,s.jsx)(I,{isOpen:b,onClose:()=>{w(!1),S(null)},onSave:e=>{C&&(N?function(e,t,n,s){let r=V(),a=r.findIndex(t=>t.id===e);if(-1===a)return null;let o={...r[a],title:t,date:T(n),color:s};return r[a]=o,R(r),o}(N.id,e.title,new Date(e.date),e.color):function(e,t,n){let s={id:J(),title:e,date:T(t),color:n,createdAt:new Date().toISOString(),status:"active"},r=V();return r.push(s),R(r),s}(e.title,new Date(e.date),e.color),er(),ea(),S(null))},date:e,mode:N?"edit":"add",initialEvent:null!=N?N:void 0}),(0,s.jsx)(U,{isOpen:L,onClose:()=>D(!1),date:e,notes:ee.notes,todos:ee.todos,events:ee.events,type:"week"}),(0,s.jsx)(U,{isOpen:O,onClose:()=>$(!1),date:e,notes:en.notes,todos:en.todos,events:en.events,type:"month"})]}):(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-b from-primary-50 to-white"})}}},function(e){e.O(0,[501,447,141,971,69,744],function(){return e(e.s=7387)}),_N_E=e.O()}]);