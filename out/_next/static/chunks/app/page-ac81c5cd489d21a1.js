(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7387:function(e,t,n){Promise.resolve().then(n.bind(n,8931))},8931:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return U}});var s=n(7437),a=n(2265),r=n(2633),o=n(6826),l=n(7990),i=n(8800),d=n(5901),c=n(4120),m=n(7423),x=n(2490),u=n(8260),h=n(9659),p=n(855),y=n(9957);let f={"2024-01-01":{name:"元旦",type:"holiday"},"2024-02-10":{name:"春节",type:"holiday"},"2024-02-11":{name:"春节",type:"holiday"},"2024-02-12":{name:"春节",type:"holiday"},"2024-02-13":{name:"春节",type:"holiday"},"2024-02-14":{name:"春节",type:"holiday"},"2024-02-15":{name:"春节",type:"holiday"},"2024-02-16":{name:"春节",type:"holiday"},"2024-02-17":{name:"春节",type:"holiday"},"2024-02-04":{name:"春节调班",type:"workday"},"2024-04-04":{name:"清明节",type:"holiday"},"2024-04-05":{name:"清明节",type:"holiday"},"2024-04-06":{name:"清明节",type:"holiday"},"2024-03-31":{name:"清明调班",type:"workday"},"2024-05-01":{name:"劳动节",type:"holiday"},"2024-05-02":{name:"劳动节",type:"holiday"},"2024-05-03":{name:"劳动节",type:"holiday"},"2024-05-04":{name:"劳动节",type:"holiday"},"2024-05-05":{name:"劳动节",type:"holiday"},"2024-04-28":{name:"劳动节调班",type:"workday"},"2024-05-11":{name:"劳动节调班",type:"workday"},"2024-06-10":{name:"端午节",type:"holiday"},"2024-06-08":{name:"端午调班",type:"workday"},"2024-09-15":{name:"中秋节",type:"holiday"},"2024-09-16":{name:"中秋节",type:"holiday"},"2024-09-17":{name:"中秋节",type:"holiday"},"2024-09-14":{name:"中秋调班",type:"workday"},"2024-10-01":{name:"国庆节",type:"holiday"},"2024-10-02":{name:"国庆节",type:"holiday"},"2024-10-03":{name:"国庆节",type:"holiday"},"2024-10-04":{name:"国庆节",type:"holiday"},"2024-10-05":{name:"国庆节",type:"holiday"},"2024-10-06":{name:"国庆节",type:"holiday"},"2024-10-07":{name:"国庆节",type:"holiday"},"2024-09-29":{name:"国庆调班",type:"workday"},"2024-10-12":{name:"国庆调班",type:"workday"},"2025-01-01":{name:"元旦",type:"holiday"},"2025-01-28":{name:"春节",type:"holiday"},"2025-01-29":{name:"春节",type:"holiday"},"2025-01-30":{name:"春节",type:"holiday"},"2025-01-31":{name:"春节",type:"holiday"},"2025-02-01":{name:"春节",type:"holiday"},"2025-02-02":{name:"春节",type:"holiday"},"2025-02-03":{name:"春节",type:"holiday"},"2025-02-04":{name:"春节",type:"holiday"},"2025-01-26":{name:"春节调班",type:"workday"},"2025-02-08":{name:"春节调班",type:"workday"},"2025-04-04":{name:"清明节",type:"holiday"},"2025-04-05":{name:"清明节",type:"holiday"},"2025-04-06":{name:"清明节",type:"holiday"},"2025-05-01":{name:"劳动节",type:"holiday"},"2025-05-02":{name:"劳动节",type:"holiday"},"2025-05-03":{name:"劳动节",type:"holiday"},"2025-05-04":{name:"劳动节",type:"holiday"},"2025-05-05":{name:"劳动节",type:"holiday"},"2025-04-27":{name:"劳动节调班",type:"workday"},"2025-05-31":{name:"端午节",type:"holiday"},"2025-06-01":{name:"端午节",type:"holiday"},"2025-06-02":{name:"端午节",type:"holiday"},"2025-10-01":{name:"国庆节",type:"holiday"},"2025-10-02":{name:"国庆节",type:"holiday"},"2025-10-03":{name:"国庆节",type:"holiday"},"2025-10-04":{name:"国庆节",type:"holiday"},"2025-10-05":{name:"国庆节",type:"holiday"},"2025-10-06":{name:"国庆节",type:"holiday"},"2025-10-07":{name:"国庆节",type:"holiday"},"2025-10-08":{name:"国庆节",type:"holiday"},"2025-09-28":{name:"国庆调班",type:"workday"},"2025-10-11":{name:"国庆调班",type:"workday"}};function g(e){return f[(0,x.Z)(e,"yyyy-MM-dd")]||null}function v(e){let{selectedDate:t,onDateSelect:n,onDateContextMenu:f,hasContent:v}=e,[j,b]=(0,a.useState)(new Date),w=(0,r.Z)(j),N=(0,o.Z)(j),k=(0,l.Z)(w,{weekStartsOn:1}),S=(0,i.Z)(N,{weekStartsOn:1}),M=(0,d.Z)({start:k,end:S});return(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("button",{onClick:()=>b((0,m.Z)(j,1)),className:"p-2 text-secondary-600 hover:text-primary-500 transition-colors",children:(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,s.jsx)("h2",{className:"text-lg font-medium text-secondary-900",children:(0,x.Z)(j,"yyyy年MM月",{locale:y.Z})}),(0,s.jsx)("button",{onClick:()=>b((0,c.Z)(j,1)),className:"p-2 text-secondary-600 hover:text-primary-500 transition-colors",children:(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),(0,s.jsx)("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["一","二","三","四","五","六","日"].map(e=>(0,s.jsx)("div",{className:"text-center text-sm font-medium text-secondary-600",children:e},e))}),(0,s.jsx)("div",{className:"grid grid-cols-7 gap-1",children:M.map(e=>{let a=v(e),r=(0,u.Z)(e,t),o=(0,h.Z)(e,j),l=g(e);!function(e){let t=g(e);null==t||t.type}(e);let i=function(e){let t=g(e);return(null==t?void 0:t.type)==="workday"}(e);return(0,p.Z)(e),(0,s.jsx)("button",{onClick:()=>n(e),onContextMenu:t=>f(e,t),className:"\n                relative p-2 text-sm transition-all\n                ".concat(r?"bg-primary-50 text-primary-600 font-medium":"hover:bg-primary-50","\n                ").concat(!o&&"text-secondary-300","\n              "),children:(0,s.jsxs)("div",{className:"relative h-6 flex items-center justify-center",children:[(0,s.jsx)("span",{className:"inline-flex items-center justify-center w-6",children:(0,x.Z)(e,"d")}),l&&(0,s.jsx)("span",{className:"\n                    absolute -top-1 -right-1 text-[10px] leading-none px-0.5\n                    ".concat(i?"text-red-500":"text-primary-500","\n                  "),children:i?"班":"休"}),(0,s.jsx)("div",{className:"absolute -bottom-1 left-1/2 transform -translate-x-1/2 flex gap-0.5 items-center",children:a.events.map(e=>(0,s.jsx)("div",{className:"w-1 h-1 rounded-full ".concat(e.color)},e.id))})]})},e.toString())})})]})}function j(e){let{date:t,initialContent:n,onSave:r}=e,[o,l]=(0,a.useState)(n),[i,d]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{l(n)},[n,t]),(0,a.useEffect)(()=>{let e=setTimeout(()=>{o===n||i||(d(!0),r(o),d(!1))},1e3);return()=>clearTimeout(e)},[o,n,i,r]),(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsx)("textarea",{value:o,onChange:e=>l(e.target.value),placeholder:"写下今天的记录...",className:"w-full h-48 p-3 text-sm border border-secondary-200 rounded-lg focus:outline-none focus:border-primary-400 focus:ring-1 focus:ring-primary-100 transition-all resize-none text-secondary-700 placeholder-secondary-400"}),(0,s.jsx)("div",{className:"flex justify-end mt-1.5",children:(0,s.jsxs)("span",{className:"text-xs text-secondary-400 flex items-center",children:[(0,s.jsx)("span",{className:"w-1.5 h-1.5 rounded-full mr-1.5 ".concat(i?"bg-primary-400 animate-pulse":"bg-green-400")}),i?"保存中...":"已自动保存"]})})]})}var b=n(5916);function w(e){let{isOpen:t,onClose:n,onSave:r,initialContent:o="",initialDate:l=new Date,mode:i}=e,[d,c]=(0,a.useState)(o),[m,u]=(0,a.useState)(l);return((0,a.useEffect)(()=>{t&&(c(o),u(l))},[t,o,l]),t)?(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg p-4 w-full max-w-sm",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-4 text-primary-600",children:"edit"===i?"编辑待办事项":"复制待办事项"}),(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),d.trim()&&(r(d.trim(),m),n())},children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-secondary-600 mb-1",children:"内容"}),(0,s.jsx)("input",{type:"text",value:d,onChange:e=>c(e.target.value),className:"w-full px-3 py-1.5 text-sm border border-secondary-200 rounded-lg focus:outline-none focus:border-primary-400 focus:ring-1 focus:ring-primary-100 transition-all",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-secondary-600 mb-1",children:"日期"}),(0,s.jsx)("input",{type:"date",value:(0,x.Z)(m,"yyyy-MM-dd"),onChange:e=>u(new Date(e.target.value)),className:"w-full px-3 py-1.5 text-sm border border-secondary-200 rounded-lg focus:outline-none focus:border-primary-400 focus:ring-1 focus:ring-primary-100 transition-all",required:!0})]})]}),(0,s.jsxs)("div",{className:"mt-4 flex justify-end gap-2",children:[(0,s.jsx)("button",{type:"button",onClick:n,className:"px-3 py-1.5 text-sm border border-secondary-200 text-secondary-600 rounded-lg hover:bg-secondary-50 transition-colors",children:"取消"}),(0,s.jsx)("button",{type:"submit",className:"px-3 py-1.5 text-sm bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:"保存"})]})]})]})}):null}function N(e){let{todos:t,selectedDate:n,onAdd:r,onToggle:o,onDelete:l,onEdit:i}=e,[d,c]=(0,a.useState)(""),[m,x]=(0,a.useState)(!1),[u,h]=(0,a.useState)(null),[p,y]=(0,a.useState)("edit"),f=e=>{h(e),y("edit"),x(!0)},g=e=>{h(e),y("copy"),x(!0)};return(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),d.trim()&&(r(d.trim(),n),c(""))},className:"flex gap-3 mb-4",children:[(0,s.jsx)("input",{type:"text",value:d,onChange:e=>c(e.target.value),placeholder:"添加新的待办事项...",className:"flex-1 px-3 py-1.5 text-sm border border-secondary-200 rounded-lg focus:outline-none focus:border-primary-400 focus:ring-1 focus:ring-primary-100 transition-all"}),(0,s.jsx)("button",{type:"submit",className:"px-4 py-1.5 text-sm bg-primary-500 text-white rounded-lg hover:bg-primary-600 focus:outline-none focus:ring-2 focus:ring-primary-200 transition-all",children:"添加"})]}),(0,s.jsx)("div",{className:"space-y-2",children:t.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between py-2 px-3 bg-white border border-secondary-200 rounded-lg hover:border-primary-200 transition-all",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("button",{onClick:()=>o(e.id),className:"w-5 h-5 rounded-md border-2 flex items-center justify-center transition-all ".concat(e.completed?"bg-primary-500 border-primary-500 text-white":"border-secondary-300 hover:border-primary-400"),children:e.completed&&(0,s.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,s.jsx)("span",{className:"text-sm text-secondary-700 transition-all ".concat(e.completed?"line-through text-secondary-400":""),children:e.content})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("button",{onClick:()=>f(e),className:"text-secondary-400 hover:text-primary-500 transition-colors p-1.5",title:"编辑",children:(0,s.jsx)(b.IYd,{className:"w-3.5 h-3.5"})}),(0,s.jsx)("button",{onClick:()=>g(e),className:"text-secondary-400 hover:text-primary-500 transition-colors p-1.5",title:"复制",children:(0,s.jsx)(b.C3L,{className:"w-3.5 h-3.5"})}),(0,s.jsx)("button",{onClick:()=>l(e.id),className:"text-secondary-400 hover:text-red-500 transition-colors p-1.5",title:"删除",children:(0,s.jsx)(b.Ybf,{className:"w-3.5 h-3.5"})})]})]},e.id))}),(0,s.jsx)(w,{isOpen:m,onClose:()=>x(!1),onSave:(e,t)=>{"edit"===p&&u?i(u.id,e,t):r(e,t)},initialContent:null==u?void 0:u.content,initialDate:(null==u?void 0:u.date)?new Date(u.date):n,mode:p})]})}let k={"bg-red-500":"红色","bg-yellow-500":"黄色","bg-blue-500":"蓝色","bg-green-500":"绿色","bg-purple-500":"紫色","bg-pink-500":"粉色"};function S(e){let{isOpen:t,onClose:n,onSave:r,date:o,mode:l="add",initialEvent:i}=e,[d,c]=(0,a.useState)(""),[m,u]=(0,a.useState)("bg-blue-500"),[h,p]=(0,a.useState)(o),y=(0,a.useRef)(null);return((0,a.useEffect)(()=>{t&&y.current&&y.current.focus()},[t]),(0,a.useEffect)(()=>{t&&i?(c(i.title),u(i.color),p(new Date(i.date))):t&&(c(""),u("bg-blue-500"),p(o))},[t,i,o]),t)?(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg p-4 w-full max-w-sm",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-4 text-primary-600",children:"add"===l?"添加事件":"编辑事件"}),(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),r({title:d,color:m,date:(0,x.Z)(h,"yyyy-MM-dd")}),c(""),u("bg-blue-500"),p(o),n()},children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-secondary-600 mb-1",children:"事件标题"}),(0,s.jsx)("input",{type:"text",value:d,ref:y,onChange:e=>c(e.target.value),className:"w-full px-3 py-1.5 text-sm border border-secondary-200 rounded-lg focus:outline-none focus:border-primary-400 focus:ring-1 focus:ring-primary-100 transition-all",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-secondary-600 mb-1",children:"日期"}),(0,s.jsx)("input",{type:"date",value:(0,x.Z)(h,"yyyy-MM-dd"),onChange:e=>p(new Date(e.target.value)),className:"w-full px-3 py-1.5 text-sm border border-secondary-200 rounded-lg focus:outline-none focus:border-primary-400 focus:ring-1 focus:ring-primary-100 transition-all",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-secondary-600 mb-1",children:"事件颜色"}),(0,s.jsx)("div",{className:"grid grid-cols-6 gap-2",children:Object.entries(k).map(e=>{let[t,n]=e;return(0,s.jsx)("button",{type:"button",onClick:()=>u(t),className:"w-8 h-8 rounded-lg ".concat(t," transition-all ").concat(m===t?"ring-2 ring-primary-400 ring-offset-2":""),title:n},t)})})]})]}),(0,s.jsxs)("div",{className:"mt-4 flex justify-end gap-2",children:[(0,s.jsx)("button",{type:"button",onClick:n,className:"px-3 py-1.5 text-sm border border-secondary-200 text-secondary-600 rounded-lg hover:bg-secondary-50 transition-colors",children:"取消"}),(0,s.jsx)("button",{type:"submit",className:"px-3 py-1.5 text-sm bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:"保存"})]})]})]})}):null}var M=n(8716);function C(e){localStorage.setItem("todos",JSON.stringify(e))}function Z(){let e=localStorage.getItem("todos");return e?JSON.parse(e):[]}function L(){return Math.random().toString(36).substring(2)+Date.now().toString(36)}function D(e){return(0,x.Z)(e,"yyyy-MM-dd")}function O(){let e=localStorage.getItem("notes");return e?JSON.parse(e):[]}function E(e){return O().find(t=>t.date===D(e))||null}function I(e){localStorage.setItem("events",JSON.stringify(e))}function W(){let e=localStorage.getItem("events");return e?JSON.parse(e):[]}function B(e){return W().filter(t=>t.date===D(e))}function A(e,t){let n=W(),s=n.findIndex(t=>t.id===e);if(-1===s)return null;let a={...n[s],status:t};return n[s]=a,I(n),a}function J(e){let t=O(),n=Z(),s=W(),a="工作记录导出\n\n";return e.forEach(e=>{let r=(0,x.Z)(e,"yyyy-MM-dd"),o=(0,x.Z)(e,"yyyy年MM月dd日 EEEE",{locale:y.Z}),l=s.filter(e=>e.date===r),i=n.filter(e=>e.date===r),d=t.find(e=>e.date===r);(0!==l.length||0!==i.length||(null==d?void 0:d.content))&&(a+="=== ".concat(o," ===\n\n"),l.length>0&&(a+="【事件】\n",l.forEach(e=>{a+="- ".concat(e.title,"\n")}),a+="\n"),i.length>0&&(a+="【待办事项】\n",i.forEach(e=>{a+="- [".concat(e.completed?"✓":" ","] ").concat(e.content,"\n")}),a+="\n"),(null==d?void 0:d.content)&&(a+="【日记】\n"+d.content+"\n\n"),a+="----------------------------\n\n")}),a}function z(e,t){let n=new Blob([e],{type:"text/plain;charset=utf-8"}),s=URL.createObjectURL(n),a=document.createElement("a");a.href=s,a.download="".concat(t,"_").concat((0,x.Z)(new Date,"yyyy-MM-dd"),".txt"),document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s)}function V(e){let{isOpen:t,onClose:n,date:c,notes:m,todos:u,events:h,type:p}=e;if(!t)return null;let f=(0,a.useRef)(null),{start:g,end:v,title:j}=(()=>{if("week"===p){let e=(0,l.Z)(c,{weekStartsOn:1}),t=(0,i.Z)(c,{weekStartsOn:1});return{start:e,end:t,title:"周报（".concat((0,x.Z)(e,"MM.dd",{locale:y.Z})," - ").concat((0,x.Z)(t,"MM.dd",{locale:y.Z}),"）")}}return{start:(0,r.Z)(c),end:(0,o.Z)(c),title:"".concat((0,x.Z)(c,"yyyy年MM月",{locale:y.Z}),"月报")}})(),b=(0,d.Z)({start:g,end:v}),w=e=>(0,x.Z)(e,"yyyy-MM-dd");return(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg w-full max-w-4xl max-h-[90vh] flex flex-col",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-secondary-200",children:[(0,s.jsx)("h2",{className:"text-base font-semibold text-primary-600",children:j}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("button",{onClick:()=>{"week"===p?function(e){let t=(0,l.Z)(e,{weekStartsOn:1}),n=(0,i.Z)(e,{weekStartsOn:1});z(J((0,d.Z)({start:t,end:n})),"周报")}(c):function(e){let t=(0,r.Z)(e),n=(0,o.Z)(e);z(J((0,d.Z)({start:t,end:n})),"月报")}(c)},className:"px-3 py-1.5 text-sm bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors flex items-center gap-1.5",title:"下载为文本",children:[(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),(0,s.jsx)("span",{children:"下载"})]}),(0,s.jsx)("button",{onClick:n,className:"text-secondary-400 hover:text-secondary-600 transition-colors",children:(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),(0,s.jsx)("div",{className:"flex-1 overflow-auto p-4",ref:f,"data-report-content":!0,children:(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 auto-rows-min",children:[b.map(e=>{let t=w(e),n=m.filter(e=>e.date===t),a=u.filter(e=>e.date===t),r=h.filter(e=>e.date===t);return 0===n.length&&0===a.length&&0===r.length?null:(0,s.jsxs)("div",{className:"border border-secondary-200 rounded-lg p-2",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-primary-600 mb-2",children:(0,x.Z)(e,"MM月dd日 EEEE",{locale:y.Z})}),r.length>0&&(0,s.jsxs)("div",{className:"mb-2",children:[(0,s.jsx)("h4",{className:"text-xs font-medium text-secondary-600 mb-1",children:"事件"}),(0,s.jsx)("div",{className:"space-y-0.5",children:r.map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-1.5 text-xs",children:[(0,s.jsx)("div",{className:"w-1.5 h-1.5 rounded-full ".concat(e.color)}),(0,s.jsx)("span",{className:"text-secondary-700",children:e.title})]},e.id))})]}),a.length>0&&(0,s.jsxs)("div",{className:"mb-2",children:[(0,s.jsx)("h4",{className:"text-xs font-medium text-secondary-600 mb-1",children:"待办事项"}),(0,s.jsx)("div",{className:"space-y-0.5",children:a.map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-1.5 text-xs",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded border flex items-center justify-center ".concat(e.completed?"bg-primary-500 border-primary-500 text-white":"border-secondary-300"),children:e.completed&&(0,s.jsx)("svg",{className:"w-1.5 h-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,s.jsx)("span",{className:"text-secondary-700 ".concat(e.completed?"line-through":""),children:e.content})]},e.id))})]}),n.map(e=>(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-xs font-medium text-secondary-600 mb-1",children:"日记"}),(0,s.jsx)("div",{className:"text-xs text-secondary-700 whitespace-pre-wrap",children:e.content})]},e.id))]},t)}),b.every(e=>{let t=w(e),n=m.filter(e=>e.date===t),s=u.filter(e=>e.date===t),a=h.filter(e=>e.date===t);return 0===n.length&&0===s.length&&0===a.length})&&(0,s.jsx)("div",{className:"text-center py-4 text-xs text-secondary-400",children:"week"===p?"本周暂无任何记录":"本月暂无任何记录"})]})})]})})}var H=n(1189),R=n(3345),_=n(8240),T=n(6678);let q=e=>e?e.replace("bg-","text-"):"text-secondary-600";function U(){let[e,t]=(0,a.useState)(new Date),[n,c]=(0,a.useState)(null),[m,u]=(0,a.useState)([]),[h,p]=(0,a.useState)([]),[f,g]=(0,a.useState)([]),[b,w]=(0,a.useState)(!1),[k,U]=(0,a.useState)(null),[F,P]=(0,a.useState)(!1),[Y,G]=(0,a.useState)(!1),[K,Q]=(0,a.useState)(!1),[X,$]=(0,a.useState)({notes:[],todos:[],events:[]}),[ee,et]=(0,a.useState)({notes:[],todos:[],events:[]});(0,a.useEffect)(()=>{P(!0)},[]),(0,a.useEffect)(()=>{F&&(en(),es())},[e,F]);let en=()=>{if(!F)return;c(E(e)),p(B(e));let t=(0,x.Z)(e,"yyyy-MM-dd");u(Z().filter(e=>e.date===t))},es=()=>{F&&g(W().filter(e=>{let t=new Date(e.date);return((0,H.Z)(t)||(0,R.Z)(t))&&(!e.status||"active"===e.status)}).sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime()))},ea=e=>{let t=new Date(e),n=new Date;if((0,H.Z)(t))return"今天";if((0,_.Z)(t))return"明天";let s=(0,T.Z)(t,n);return"".concat((0,x.Z)(t,"MM.dd",{locale:y.Z}),"（").concat(s,"天后）")},er=e=>{U(e),w(!0)},eo=()=>{if(!F)return;let t=(0,l.Z)(e,{weekStartsOn:1}),n=(0,i.Z)(e,{weekStartsOn:1}),s=(0,d.Z)({start:t,end:n}),a=[],r=[],o=[];s.forEach(e=>{let t=E(e);t&&a.push(t);let n=(0,x.Z)(e,"yyyy-MM-dd"),s=Z().filter(e=>e.date===n);r.push(...s);let l=B(e);o.push(...l)}),$({notes:a,todos:r,events:o})},el=()=>{if(!F)return;let t=(0,r.Z)(e),n=(0,o.Z)(e),s=(0,d.Z)({start:t,end:n}),a=[],l=[],i=[];s.forEach(e=>{let t=E(e);t&&a.push(t);let n=(0,x.Z)(e,"yyyy-MM-dd"),s=Z().filter(e=>e.date===n);l.push(...s);let r=B(e);i.push(...r)}),et({notes:a,todos:l,events:i})};return F?(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-b from-primary-50 to-white",children:[(0,s.jsxs)("main",{className:"container mx-auto px-4 py-6 max-w-6xl",children:[(0,s.jsxs)("h1",{className:"text-sm font-medium text-primary-600 text-center mb-6 flex items-center justify-center gap-1",children:[(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 14s1.5 2 4 2 4-2 4-2M9 9h.01M15 9h.01M20 12a8 8 0 11-16 0 8 8 0 0116 0z"})}),"饼干工作日记"]}),(0,s.jsxs)("div",{className:"flex gap-4 mb-6",children:[(0,s.jsx)("div",{className:"max-h-[100px] bg-white rounded-xl shadow-soft p-2.5 overflow-y-auto flex-1 max-w-[600px]",children:(0,s.jsxs)("div",{className:"space-y-0.5",children:[f.map(e=>(0,s.jsxs)("div",{className:"grid grid-cols-[1.5rem,6rem,1fr] items-center",children:[(0,s.jsx)("div",{className:"flex items-center justify-center",children:(0,s.jsx)("div",{className:"w-1.5 h-1.5 rounded-full ".concat(e.color||"bg-secondary-400")})}),(0,s.jsx)("div",{className:"text-xs text-secondary-500",children:ea(e.date)}),(0,s.jsx)("div",{className:"text-xs text-secondary-700 truncate pr-2",children:e.title})]},e.id)),0===f.length&&(0,s.jsx)("div",{className:"py-2 flex items-center justify-center text-xs text-secondary-400",children:"暂无即将发生的事件"})]})}),(0,s.jsxs)("div",{className:"flex items-center gap-2 ml-auto",children:[(0,s.jsxs)("button",{onClick:()=>{t(new Date)},className:"h-[60px] px-3 bg-white rounded-xl shadow-soft text-xs text-secondary-600 hover:text-primary-500 transition-colors flex flex-col items-center justify-center gap-0.5",children:[(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,s.jsx)("span",{children:"今天"})]}),(0,s.jsxs)("button",{onClick:()=>{eo(),G(!0)},className:"h-[60px] px-3 bg-white rounded-xl shadow-soft text-xs text-secondary-600 hover:text-primary-500 transition-colors flex flex-col items-center justify-center gap-0.5",children:[(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,s.jsx)("span",{children:"周报"})]}),(0,s.jsxs)("button",{onClick:()=>{el(),Q(!0)},className:"h-[60px] px-3 bg-white rounded-xl shadow-soft text-xs text-secondary-600 hover:text-primary-500 transition-colors flex flex-col items-center justify-center gap-0.5",children:[(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),(0,s.jsx)("span",{children:"月报"})]}),(0,s.jsxs)("button",{onClick:()=>{let e=document.createElement("input");e.type="file",e.accept=".txt",e.onchange=async e=>{var t;let n=null===(t=e.target.files)||void 0===t?void 0:t[0];if(n)try{await new Promise((e,t)=>{let s=new FileReader;s.onload=async n=>{try{var s,a;let t=(null===(s=n.target)||void 0===s?void 0:s.result).replace(/^工作记录导出\n+/,""),r=t.split(/===[\s\S]*?===/).filter(e=>e.trim()),o=(null===(a=t.match(/===\s*(.*?)\s*===/g))||void 0===a?void 0:a.map(e=>e.replace(/===\s*|\s*===/g,"").trim()))||[],l=[],i=[],d=[];if(r.forEach((e,t)=>{if(!o[t])return;let n=o[t].match(/(\d{4})年(\d{2})月(\d{2})日/);if(!n)return;let s=new Date(parseInt(n[1]),parseInt(n[2])-1,parseInt(n[3])),a=(0,x.Z)(s,"yyyy-MM-dd"),r="",c="",m=e.trim().split("\n");for(let e=0;e<m.length;e++){let t=m[e].trim();if(t&&"----------------------------"!==t){if("【事件】"===t){r="events";continue}if("【待办事项】"===t){r="todos";continue}if("【日记】"===t){r="notes";continue}if("events"===r&&t.startsWith("-")){let e=t.slice(2).trim();d.push({id:Math.random().toString(36).substring(2)+Date.now().toString(36),title:e,date:a,color:"bg-blue-500",createdAt:new Date().toISOString()})}else if("todos"===r&&t.startsWith("-")){let e=t.includes("[✓]"),n=t.slice(t.indexOf("]")+1).trim();i.push({id:Math.random().toString(36).substring(2)+Date.now().toString(36),content:n,completed:e,date:a,createdAt:new Date().toISOString(),completedAt:e?new Date().toISOString():void 0})}else"notes"===r&&(c+=(c?"\n":"")+t)}}if(c){let e=new Date().toISOString();l.push({id:Math.random().toString(36).substring(2)+Date.now().toString(36),content:c,date:a,createdAt:e,updatedAt:e})}}),0===l.length&&0===i.length&&0===d.length)throw Error("没有解析到任何数据");localStorage.clear(),localStorage.setItem("notes",JSON.stringify(l)),localStorage.setItem("todos",JSON.stringify(i)),localStorage.setItem("events",JSON.stringify(d)),e()}catch(e){t(e)}},s.onerror=()=>t(Error("文件读取失败")),s.readAsText(n)}),en(),es(),alert("导入成功！页面将刷新以显示导入的数据。"),window.location.reload()}catch(e){console.error("导入失败:",e),alert("导入失败，请确保文件格式正确。")}},e.click()},className:"h-[60px] px-3 bg-white rounded-xl shadow-soft text-xs text-secondary-600 hover:text-primary-500 transition-colors flex flex-col items-center justify-center gap-0.5",children:[(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),(0,s.jsx)("span",{children:"导入"})]}),(0,s.jsxs)("button",{onClick:()=>{F&&function(){let e=O(),t=Z(),n=W(),s=new Set;e.forEach(e=>s.add(e.date)),t.forEach(e=>s.add(e.date)),n.forEach(e=>s.add(e.date)),z(J(Array.from(s).sort().map(e=>(0,M.Z)(e))),"工作记录")}()},className:"h-[60px] px-3 bg-white rounded-xl shadow-soft text-xs text-secondary-600 hover:text-primary-500 transition-colors flex flex-col items-center justify-center gap-0.5",children:[(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),(0,s.jsx)("span",{children:"导出"})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[(0,s.jsxs)("div",{className:"lg:col-span-4 space-y-4",children:[(0,s.jsx)("div",{className:"bg-white rounded-xl shadow-soft p-4",children:(0,s.jsx)(v,{selectedDate:e,onDateSelect:e=>{t(e)},onDateContextMenu:(e,n)=>{n.preventDefault(),t(e),w(!0)},hasContent:e=>F?{events:B(e).filter(e=>!e.status||"active"===e.status)}:{events:[]}})}),(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-soft p-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-primary-600",children:"事件"}),(0,s.jsx)("button",{onClick:()=>w(!0),className:"px-3 py-1 text-sm bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:"添加"})]}),(0,s.jsxs)("div",{className:"space-y-1.5",children:[h.map(e=>(0,s.jsxs)("div",{className:"py-1.5 px-2 rounded-lg border border-secondary-200 flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-1.5 h-1.5 rounded-full ".concat(e.color||"bg-secondary-400")}),(0,s.jsxs)("div",{className:"text-xs font-medium flex-1 ".concat(q(e.color)),children:[e.title,e.status&&"active"!==e.status&&(0,s.jsxs)("span",{className:"ml-2 text-secondary-400",children:["(","cancelled"===e.status?"已取消":"已延期",")"]})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(!e.status||"active"===e.status)&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"group relative",children:[(0,s.jsx)("button",{onClick:()=>{F&&(A(e.id,"cancelled"),en(),es())},className:"text-secondary-400 hover:text-red-500 transition-colors p-0.5",children:(0,s.jsx)("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})}),(0,s.jsx)("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-1 px-2 py-1 text-xs text-white bg-gray-800 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap",children:"标记为已取消"})]}),(0,s.jsxs)("div",{className:"group relative",children:[(0,s.jsx)("button",{onClick:()=>{F&&(A(e.id,"postponed"),en(),es())},className:"text-secondary-400 hover:text-yellow-500 transition-colors p-0.5",children:(0,s.jsx)("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,s.jsx)("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-1 px-2 py-1 text-xs text-white bg-gray-800 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap",children:"标记为已延期"})]})]}),e.status&&"active"!==e.status&&(0,s.jsxs)("div",{className:"group relative",children:[(0,s.jsx)("button",{onClick:()=>{F&&(A(e.id,"active"),en(),es())},className:"text-secondary-400 hover:text-green-500 transition-colors p-0.5",children:(0,s.jsx)("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),(0,s.jsx)("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-1 px-2 py-1 text-xs text-white bg-gray-800 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap",children:"恢复为活动状态"})]}),(0,s.jsxs)("div",{className:"group relative",children:[(0,s.jsx)("button",{onClick:()=>er(e),className:"text-secondary-400 hover:text-primary-500 transition-colors p-0.5",children:(0,s.jsx)("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),(0,s.jsx)("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-1 px-2 py-1 text-xs text-white bg-gray-800 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap",children:"编辑事件"})]}),(0,s.jsxs)("div",{className:"group relative",children:[(0,s.jsx)("button",{onClick:()=>{F&&(!function(e){let t=W(),n=t.findIndex(t=>t.id===e);-1!==n&&(t.splice(n,1),I(t))}(e.id),en(),es())},className:"text-secondary-400 hover:text-red-500 transition-colors p-0.5",children:(0,s.jsx)("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),(0,s.jsx)("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-1 px-2 py-1 text-xs text-white bg-gray-800 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap",children:"删除事件"})]})]})]},e.id)),0===h.length&&(0,s.jsx)("div",{className:"text-center py-3 text-xs text-secondary-400",children:"暂无事件"})]})]})]}),(0,s.jsxs)("div",{className:"lg:col-span-8 space-y-4",children:[(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-soft p-4",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-3 text-primary-600",children:"日记"}),(0,s.jsx)(j,{date:e,initialContent:(null==n?void 0:n.content)||"",onSave:t=>{F&&(!function(e,t){let n=O(),s=n.find(e=>e.date===D(t)),a=new Date().toISOString();s?(s.content=e,s.updatedAt=a):n.push({id:L(),content:e,date:D(t),createdAt:a,updatedAt:a}),localStorage.setItem("notes",JSON.stringify(n))}(t,e),en())}})]}),(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-soft p-4",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-3 text-primary-600",children:"待办事项"}),(0,s.jsx)(N,{todos:m,selectedDate:e,onAdd:(e,t)=>{F&&(u([...m,function(e,t){let n=Z(),s={id:L(),content:e,completed:!1,date:D(t),createdAt:new Date().toISOString()};return n.push(s),localStorage.setItem("todos",JSON.stringify(n)),s}(e,t)]),en())},onToggle:e=>{F&&(!function(e){let t=Z(),n=t.find(t=>t.id===e);n&&(n.completed=!n.completed,n.completedAt=n.completed?new Date().toISOString():void 0,C(t))}(e),u(Z()),en())},onDelete:e=>{F&&(!function(e){let t=Z(),n=t.findIndex(t=>t.id===e);-1!==n&&(t.splice(n,1),C(t))}(e),u(Z()),en())},onEdit:(e,t,n)=>{F&&(!function(e,t,n){let s=Z(),a=s.findIndex(t=>t.id===e);if(-1===a)return;let r={...s[a],content:t,date:D(n)};s[a]=r,localStorage.setItem("todos",JSON.stringify(s))}(e,t,n),u(Z()),en())}})]})]})]})]}),(0,s.jsx)(S,{isOpen:b,onClose:()=>{w(!1),U(null)},onSave:e=>{F&&(k?function(e,t,n,s){let a=W(),r=a.findIndex(t=>t.id===e);if(-1===r)return null;let o={...a[r],title:t,date:D(n),color:s};return a[r]=o,I(a),o}(k.id,e.title,new Date(e.date),e.color):function(e,t,n){let s={id:L(),title:e,date:D(t),color:n,createdAt:new Date().toISOString(),status:"active"},a=W();return a.push(s),I(a),s}(e.title,new Date(e.date),e.color),en(),es(),U(null))},date:e,mode:k?"edit":"add",initialEvent:null!=k?k:void 0}),(0,s.jsx)(V,{isOpen:Y,onClose:()=>G(!1),date:e,notes:X.notes,todos:X.todos,events:X.events,type:"week"}),(0,s.jsx)(V,{isOpen:K,onClose:()=>Q(!1),date:e,notes:ee.notes,todos:ee.todos,events:ee.events,type:"month"})]}):(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-b from-primary-50 to-white"})}}},function(e){e.O(0,[428,971,69,744],function(){return e(e.s=7387)}),_N_E=e.O()}]);